<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/zio-grpc/blog/rss.xml" title="ZIO gRPC Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zio-grpc/blog/atom.xml" title="ZIO gRPC Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-346180-20","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><title data-react-helmet="true">Generated Code Reference | ZIO gRPC</title><meta data-react-helmet="true" property="og:image" content="https://scalapb.github.io/zio-grpc/img/zio-grpc-social-light.png"><meta data-react-helmet="true" name="twitter:image" content="https://scalapb.github.io/zio-grpc/img/zio-grpc-social-light.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for ZIO gRPC"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Generated Code Reference | ZIO gRPC"><meta data-react-helmet="true" name="description" content="Packages and code location"><meta data-react-helmet="true" property="og:description" content="Packages and code location"><meta data-react-helmet="true" property="og:url" content="https://scalapb.github.io/zio-grpc//zio-grpc/docs/generated-code"><link data-react-helmet="true" rel="shortcut icon" href="/zio-grpc/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://scalapb.github.io/zio-grpc//zio-grpc/docs/generated-code"><link rel="stylesheet" href="/zio-grpc/styles.221113e6.css">
<link rel="preload" href="/zio-grpc/styles.443da1a6.js" as="script">
<link rel="preload" href="/zio-grpc/runtime~main.1fd13f55.js" as="script">
<link rel="preload" href="/zio-grpc/main.ddfc68a5.js" as="script">
<link rel="preload" href="/zio-grpc/1.a11d6672.js" as="script">
<link rel="preload" href="/zio-grpc/2.dac6a48c.js" as="script">
<link rel="preload" href="/zio-grpc/17.a95edccd.js" as="script">
<link rel="preload" href="/zio-grpc/18.c8845ae8.js" as="script">
<link rel="preload" href="/zio-grpc/935f2afb.bd965fee.js" as="script">
<link rel="preload" href="/zio-grpc/17896441.c723b56f.js" as="script">
<link rel="preload" href="/zio-grpc/b484f81c.88c2e6d7.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/zio-grpc/"><img src="/zio-grpc/img/zio-grpc-hero.png" alt="ZIO gRPC" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/zio-grpc/img/zio-grpc-hero.png" alt="ZIO gRPC" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title"> </strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zio-grpc/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/scalapb/zio-grpc" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/zio-grpc/"><img src="/zio-grpc/img/zio-grpc-hero.png" alt="ZIO gRPC" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/zio-grpc/img/zio-grpc-hero.png" alt="ZIO gRPC" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title"> </strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/zio-grpc/docs/">Docs</a></li><li class="menu__list-item"><a href="https://github.com/scalapb/zio-grpc" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zio-grpc/docs/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zio-grpc/docs/quickstart">Quick Start</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zio-grpc/docs/basics">Basics Tutorial</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zio-grpc/docs/installation">Installing</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/zio-grpc/docs/generated-code">Generated code</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zio-grpc/docs/context">Context and Dependencies</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zio-grpc/docs/decorating">Decorating services</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zio-grpc/docs/deadlines">ZIO gRPC and Deadlines</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zio-grpc/docs/scala.js">Scala.js</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Generated Code Reference</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="packages-and-code-location"></a>Packages and code location<a class="hash-link" href="#packages-and-code-location" title="Direct link to heading">#</a></h2><p>For each proto file that contains services definition, ZIO gRPC generates a Scala
object that will contain service definitions for all services in that file. The
object name would be the proto file name prefixed with <code>Zio</code>. It would reside in the same Scala package that ScalaPB will use for definitions in that file.</p><p>You can read more on how ScalaPB determines the Scala package name and how can this be customized in <a href="https://scalapb.github.io/generated-code.html#default-package-structure" target="_blank" rel="noopener noreferrer">ScalaPB&#x27;s documentation</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="service-trait"></a>Service trait<a class="hash-link" href="#service-trait" title="Direct link to heading">#</a></h2><p>Inside the object, for each service <code>ServiceName</code> that is defined in a <code>.proto</code> file, the following structure is generated:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-scala codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">trait ZServiceName[R, Context] {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  // methods for each RPC</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  def sayHello(request: HelloRequest):</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    ZIO[R with Context, Status, HelloReply]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div><div class="token-line" style="color:#403f53"><span class="token plain">type ServiceName = ZServiceName[Any, Any]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The trait <code>ZServiceName</code> is to be extended when implementing a server for this service. The trait takes two type parameters: <code>R</code> and <code>Context</code>:</p><ul><li><code>R</code> representes the dependencies of the service. All the effects being returned by these methods depend on <code>R</code> to encode this dependency.</li><li><code>Context</code> represents any domain object that you would like your RPC methods to have available in the environment.</li></ul><p>You can set both <code>R</code> and <code>Context</code> to be <code>Any</code> when implementing a service to indicate that the service does not have any dependencies or expectations from the environment. Since it is very common situation, especially when getting started, you can have your service implementation extends <code>ServiceName</code> which is a type alias to <code>ZServiceName[Any, Any]</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-scala codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">trait ServiceNameImpl extends ServiceName {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Learn more about using <a href="/zio-grpc/docs/context">context and dependencies</a> in the next section.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p><strong>Why <code>Any</code> means that there are no dependencies?</strong> All Scala objects are instances of <code>Any</code>. Therefore, any object that is provided as a dependency to our service would satisfy being of type <code>Any</code>. In other words, there is no specific instance type required.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="running-the-server"></a>Running the server<a class="hash-link" href="#running-the-server" title="Direct link to heading">#</a></h3><p>The easiest way to run a service, is to create an object that extends <code>scalapb.zio_grpc.ServerMain</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-scala codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">import scalapb.zio_grpc.{ServerMain, ServiceList}</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">object MyMain extends ServerMain {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  def services = ServiceList.add(ServiceNameImpl)</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  // Default port is 9000</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  override def port: Int = 8980</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>You can also override <code>def port: Int</code> to set a port number (by default port 9000 is used).</p><p><code>ServiceList</code> contains additional methods to add services to the service list that can be used when the service must be created effectfully, or wrapped in a managed, or provided to you as a layer.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="client-trait"></a>Client trait<a class="hash-link" href="#client-trait" title="Direct link to heading">#</a></h2><p>The generated client follows <a href="https://zio.dev/docs/howto/howto_use_layers" target="_blank" rel="noopener noreferrer">ZIO&#x27;s module pattern</a>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-scala codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">type ServiceNameClient = Has[ServiceNameClient.Service]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">object ServiceNameClient {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  trait ZService[R] {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    // methods for use as a client</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    def sayHello(request: HelloRequest):</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      ZIO[R, Status, HelloReply]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  type Service = ZService[Any]</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  // accessor methods</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  def sayHello(request: HelloRequest):</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    ZIO[ServiceNameClient, Status, HelloReply]</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  def managed[R](</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      managedChannel: ZManagedChannel[R],</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      options: CallOptions =</span></div><div class="token-line" style="color:#403f53"><span class="token plain">          io.grpc.CallOptions.DEFAULT,</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      headers: zio.UIO[SafeMetadata] =</span></div><div class="token-line" style="color:#403f53"><span class="token plain">          scalapb.zio_grpc.SafeMetadata.make</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  ): zio.Managed[Throwable, ZService[R]]</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  def live[R](</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      managedChannel: ZManagedChannel[R],</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      options: CallOptions =</span></div><div class="token-line" style="color:#403f53"><span class="token plain">          io.grpc.CallOptions.DEFAULT,</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      headers: zio.UIO[scalapb.zio_grpc.SafeMetadata] =</span></div><div class="token-line" style="color:#403f53"><span class="token plain">          scalapb.zio_grpc.SafeMetadata.make</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  ): zio.ZLayer[R, Throwable, ServiceNameClient]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>We have two ways to use a client: through a managed resource, or through a layer. In both cases, we start by creating a <code>ZManagedChannel</code>, which represents a communication channel to a gRPC server as a managed resource. Since it is wrapped in <a href="https://zio.dev/docs/datatypes/datatypes_managed" target="_blank" rel="noopener noreferrer">ZIO&#x27;s <code>Managed</code></a>, proper shutdown of the channel is guaranteed:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-scala codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">type ZManagedChannel[R] = Managed[Throwable, ZChannel[R]]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Creating a channel:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-scala codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">import scalapb.zio_grpc.ZManagedChannel</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import io.grpc.ManagedChannelBuilder</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">val channel = ZManagedChannel(</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  ManagedChannelBuilder</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    .forAddress(&quot;localhost&quot;, 8980)</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    .usePlaintext()</span></div><div class="token-line" style="color:#403f53"><span class="token plain">)</span></div><div class="token-line" style="color:#403f53"><span class="token plain">// channel: ZManagedChannel[Any] = zio.ZManaged$$anon$2@7ce5b854</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="using-the-client-as-a-layer"></a>Using the client as a layer<a class="hash-link" href="#using-the-client-as-a-layer" title="Direct link to heading">#</a></h3><p>A single <code>ZManagedChannel</code> represent a virtual connection to a conceptual endpoint to perform RPCs. A channel can have many actual connection to the endpoint. Therefore, it is very common to have a single service client for each RPC service you need to connect to. You can create a <code>ZLayer</code> to provide this service using the <code>live</code> method on the client companion object. Then simply write your logic using the accessor methods. Finally, inject the layer using <code>provideCustomLayer</code> at the top of your app:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-scala codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">import myexample.testservice.ZioTestservice.ServiceNameClient</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import myexample.testservice.{Request, Response}</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import zio._</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import zio.console._</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">// create layer:</span></div><div class="token-line" style="color:#403f53"><span class="token plain">val clientLayer = ServiceNameClient.live(channel)</span></div><div class="token-line" style="color:#403f53"><span class="token plain">// clientLayer: ZLayer[Any, Throwable, Has[ServiceNameClient.ZService[Any, Any]]] = Managed(</span></div><div class="token-line" style="color:#403f53"><span class="token plain">//   zio.ZManaged$$anon$2@6015d55c</span></div><div class="token-line" style="color:#403f53"><span class="token plain">// )</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">val myAppLogicNeedsEnv = for {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  // use layer through accessor methods:</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  res &lt;- ServiceNameClient.unary(Request())</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  _ &lt;- putStrLn(res.toString)</span></div><div class="token-line" style="color:#403f53"><span class="token plain">} yield ()</span></div><div class="token-line" style="color:#403f53"><span class="token plain">// myAppLogicNeedsEnv: ZIO[Has[ServiceNameClient.ZService[Any, Any]] with Any with Console, io.grpc.Status, Unit] = zio.ZIO$FlatMap@9e5af5e</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">// myAppLogicNeedsEnv needs access to a ServiceNameClient. We turn it into</span></div><div class="token-line" style="color:#403f53"><span class="token plain">// a self-contained effect (IO) by providing the layer to it:</span></div><div class="token-line" style="color:#403f53"><span class="token plain">val myAppLogic1 = myAppLogicNeedsEnv.provideCustomLayer(clientLayer)</span></div><div class="token-line" style="color:#403f53"><span class="token plain">// myAppLogic1: ZIO[ZEnv, Object, Unit] = zio.ZIO$CheckInterrupt@4d18ffd0</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">object LayeredApp extends zio.App {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  def run(args: List[String]): URIO[ZEnv, ExitCode] = myAppLogic1.exitCode</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Here the application is broken to multiple value assignments so you can see the types.
The first effect <code>myAppLogicNeedsEnv</code> uses accessor functions, which makes it depend on  an environment of type <code>ServiceNameClient</code>. It chains the <code>unary</code> RPC with printing the result to the console, and hence the final inferred effect type is <code>ServiceNameClient with Console</code>. Once we provide our custom layer, the effect type is <code>ZEnv</code>, which we can use with ZIO&#x27;s run method.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="using-a-managed-client"></a>Using a Managed Client<a class="hash-link" href="#using-a-managed-client" title="Direct link to heading">#</a></h3><p>As an alternative to using ZLayer, you can use the client through a managed resource:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-scala codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">import myexample.testservice.ZioTestservice.ServiceNameClient</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import myexample.testservice.{Request, Response}</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">val clientManaged = ServiceNameClient.managed(channel)</span></div><div class="token-line" style="color:#403f53"><span class="token plain">// clientManaged: Managed[Throwable, ServiceNameClient.ZService[Any, Any]] = zio.ZManaged$$anon$2@1c6ed93f</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">val myAppLogic = for {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  res &lt;- clientManaged.use(</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    client =&gt;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      client.unary(Request()).mapError(_.asRuntimeException)</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  )</span></div><div class="token-line" style="color:#403f53"><span class="token plain">} yield res</span></div><div class="token-line" style="color:#403f53"><span class="token plain">// myAppLogic: ZIO[Any with Any, Throwable, Response] = zio.ZIO$FlatMap@521f40db</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Since the service acquistion (through the ZManaged) can fail with a <code>Throwable</code>, and the RPC effects of ZIO gRPC can fail with <code>Status</code> (which is not a subtype of <code>Throwable</code>), we use <code>mapError</code> to map the RPC error to a <code>StatusRuntimeException</code>. This way, the resulting effect can fail with a <code>Throwable</code>.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/scalapb/zio-grpc/edit/master/docs/generated-code.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/zio-grpc/docs/installation"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Installing ZIO gRPC</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/zio-grpc/docs/context"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Context and Dependencies Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#packages-and-code-location" class="table-of-contents__link">Packages and code location</a></li><li><a href="#service-trait" class="table-of-contents__link">Service trait</a><ul><li><a href="#running-the-server" class="table-of-contents__link">Running the server</a></li></ul></li><li><a href="#client-trait" class="table-of-contents__link">Client trait</a><ul><li><a href="#using-the-client-as-a-layer" class="table-of-contents__link">Using the client as a layer</a></li><li><a href="#using-a-managed-client" class="table-of-contents__link">Using a Managed Client</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/zio-grpc/docs/">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/zio-grpc/docs/installation">Installation</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/scalapb" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://gitter.im/ScalaPB/community" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/scalapb/zio-grpc" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 <a href="https://www.linkedin.com/in/nadav-samet/">Nadav Samet</a></div></div></div></footer></div>
<script src="/zio-grpc/styles.443da1a6.js"></script>
<script src="/zio-grpc/runtime~main.1fd13f55.js"></script>
<script src="/zio-grpc/main.ddfc68a5.js"></script>
<script src="/zio-grpc/1.a11d6672.js"></script>
<script src="/zio-grpc/2.dac6a48c.js"></script>
<script src="/zio-grpc/17.a95edccd.js"></script>
<script src="/zio-grpc/18.c8845ae8.js"></script>
<script src="/zio-grpc/935f2afb.bd965fee.js"></script>
<script src="/zio-grpc/17896441.c723b56f.js"></script>
<script src="/zio-grpc/b484f81c.88c2e6d7.js"></script>
</body>
</html>